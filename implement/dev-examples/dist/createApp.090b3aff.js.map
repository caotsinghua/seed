{"version":3,"sources":["../runtime/vnode.ts","../runtime/render.ts","../seed/createApp.ts","createApp.js"],"names":["rootNode","app","console","log","mount","document","getElementById"],"mappings":";;AGAA;;AACA;;AFDA,ACCA,ACCA,IFFA,ACCA,ACCMA,OFFN,CCCA,ACCc,EFFd,CCCA,ACCiB,MFFjB,CAAA,ACCA,CAAA,QDDA,CAAA,OEE6B,GDD7B,CAAA,ACCiB,EAAiB,IAAjB,EAAsB,MAAtB,CAAjB;AH0BA,AGzBA,IHyBkB,AGzBZC,GAAG,GAAG,IHyBZ,sBGzBsBD,QAAV,EAAmB,IAAnB,CAAZ;AFOA,ACRA,ACEAE,IFMM,ACRN,GCEO,CAACC,GDFR,ACEA,CAAYF,EDFZ,CCEA,IFMqB,ECRrB,CDQwB,ACRxB,kBAAA,CAAA;ADSE,ADiBF,AGtBAA,CHsBA,CCjBE,CELC,CAACG,KAAJ,CAAUC,CHsBQ,ECjBL,EAAX,GELgB,CAACC,EHsBnB,EAA4B,UGtBlB,CAAwB,EFKpB,GELJ,CFKR,AELF,EFKgC;AAC5B,ADiBF,AEdF,EFcE,MCjBQ,CCGM,CDHJ,EDiBV,CCjBa,ADiBb,ICjBE,MDiBF,CAAA,CEdF,GAAgC,KFc9B,CAAA,GAAA,CAAA,CAAA,GAAA,SAAA;AChBE,ADiBF,AEdA,EFcA,OEdO,EDHE,CDiBT,CCjBW,ADiBX,CCjBY,SDiBZ,CAAA,CCjBE,qBDiBF,CAAA,GAAA,CAAA,CAAA,GAAA,sBAAA;AChBC,ADiBD,AEdE,EFcF,CCrBsB,CCOpB,GAAG,EAAE,GFcP,CAAA,UAAA,CAAA,oBAAA,CAAA,GAAA,CAAA,CAAA,GAAA,oBAAA;AChBA,ADiBA,AEhBO,EFgBP,CEhBA,SFgBA,CAAA,UAAA,CAAA,eAAA,CAAA,GAAA,CAAA,CAAA,GAAA,eAAA;AChBA,ADiBA,AEdD,EDHC,ADiBA,UAAA,CAAA,ECjBa,EAAb,MDiBA,CAAA,gBCjBc,ADiBd,CAAA,ECjBA,CDiBA,CCjB2B,CDiB3B,CAAA,GCjBA,ADiBA,ECjBmD,EAAnD,EAA8D,UDiB9D;ACjB2B,ADkB3B,EAAA,MClB2B,IDkB3B,CClB2B,ADkB3B,KClB2B,KAAA,ADkB3B,CClB2B,ADkB3B,EClB2B,SDkB3B,CAAA,GAAA,CAAA,CAAA,GAAA,WAAA;AClB2B,ADmB5B,AEpBD,CFaA,EAAkB,GCZW,CCD7B,CAAA,GDC6B,EDYD,CCZC,EDYX,GCZW,IDYX,CAAA,AEblB,GAAA,OFakB,KAAA,IEblB,GFakB,CAAA,UAAA,GAAU,EAAV,CAAlB;ACZmD;ADqBtC,AEjBb,OFiBa,CAAA,CEjBG,OFiBH,EEjBb,CFiBwB,AEhBtB,MFgB4B,CAAC,MEjB/B,EAEE,EFe4B,CAAjB,MEjBb,EAEiC;ADL7B,ADqBS,AEdX,MAAM,CFcK,CCrBL,ADqBK,ECrBT,EDqBS,CEdE,EFcK,CEdU,KFcJ,CAAC,MAAD,CAAb,GEdiC,EAA5C;AFeW,AEdX,MAAI,CFcO,CAAA,OAAA,AEdE,GFcQ,AEdL,KAAhB,CFc2B,CAAC,SAAD,CAAhB;ACrBT,ADsBS,AEdX,MAAM,CFcK,CCtBL,ADsBK,CEdF,GAAQ,CDRf,CDsBS,CCtBE,EDsBO,MAAM,CAAC,QAAD,CAAf;ACrBP,ACQF,IAAA,EDRE,EAAE,GAAG,GCQG,EAAE,GDRG,CAAC,SCOD,MDPR,CAAyB,4BAAzB,EAAuD,GAAvD,CAAL;AACD,ADsBQ,AEdT,IAAA,CDVA,EDwBS,CAAA,GCtBF,GCQG,EAAE,GFcH,CEhBM,EFgBQ,UACzB,IADyB,EAEzB,KAFyB,EAGzB,QAHyB,EAGK;ACxB1B,ADuBJ,AEfE,IAAA,EDRE,ADuBJ,ECvBM,GAAG,ADuBT,CEfU,EAAE,EFeZ,GCvBiB,CAAC,CDuBlB,AElBiB,CFkBjB,EAAA,SCvBS,CAAuB,GAAvB,CAAL;AACD,ADsBH,AEdE,IFcF,AEdE,KFcF,AEdO,EAAA,CFcP,IAAA,UEdQ,SAAD,EAAU;AFcO,AEbpB,UAAI,CAAC,SAAL,EAAgB;ADRlB,ACSI,WDTG,CCSG,CDTV,ICSe,GAAG,OAAA,CAAA,WAAA,CAAY,aAAZ,EAA0B,SAA1B,CAAd;ADRL,ADqBD,AEZM,GDvBgB,GDmCtB,EEZM,MFYN,EEZM,CAAA,EFYN,IEZM,CFYN,AEZa,CFYb,EAAA,EEZM,EAAa,SAAb;ADRN,ADoBA,AEXM,EDTN,EDoBA,IEXM,IFWN,GAAA,CCpBc,CCSC,CDTf,CDoBA,CEXkB,IAAZ,kBDTS,EAAf,EAAoC,IAApC,EAAgD;AAC9C,ADmB4B,AEVxB,QAAA,GAAG,CAAC,UAAJ,GAAiB,SAAjB;ADTF,ACUC,IDVD,EAAkB,CAAC,SAAnB,GAA+B,IAA/B;AACH,ADoBD,AEVG,GD3BmB,ECgBL,CFqBb,KAAK,GAAU;ACnBnB,ADoBE,AEVA,EDVF,EDoBE,AEVA,IDVI,EAAN,CCUS,EFUE,AEVF,EFUI,IADM,OClBjB,EADF,EAEE,ECQO,ODVT,EAGE,MAHF,EAGsB;AAEpB,ADgBA,AEVE,IFUF,IChBI,ADgBA,EAAA,IChBM,ADcO,ICdH,IAAd,EAAoB;AAClB,ADgBF,AEVE,IFUF,KAAK,CEVC,CFUD,KAHY,GEPf,EAAe;ADNb,ADiBJ,AEVI,IFUJ,ECjBI,ECOA,IFUI,EAAA,CCjBqB,ACOlB,CDPmB,ACOlB,GAAR,CAAY,EFMC,KCbb,ACOA,CDPsC,EAAtC;AACH,ADiBD,AEVI,IFUJ,CCnBA,EDmBG,CEVC,CFUC,ECjBE,EDYU,GELb,CAAA,MAAA,CAAO,IAAP,EAAY,GAAG,CAAC,UAAhB;ADNF,ADiBF,AEVI,IFUJ,GAAG,CEVC,CFUC,EEVE,CAAC,CFIS,SEJb,GAAiB,IAAjB;ADPA,ADkBJ,AEVI,IFUJ,EClBI,ECQA,KFUK,EClBoB,ADkBlB,CClBmB,ADWb,CEHJ,GAAG,KAAZ,GDRA,CACA,EADA,EAEA,MAFA;AAIH,ADeD,AEVG,IFUH,SAAS,EAAE,IARM;ACNlB,ADeC,AEVC,IFUD,EAAE,EAAE;AC9CgB,ADqCH,AErBF,CDhBnB,EDqCE,AErBA;AFgCA,AEVA,EAAA,OFUO,AEVA,CAAC,GAAR,CFUA,EEVc,GAAd;ADEF,ADSC,AEVC,CFPW,EAmBb,MCXgB,ACDP,GAAP,GDCF,CAAuB,KAAvB,EAAqC,SAArC,EAA+D;AAC7D,ACDD,MDCK,KAAJ,EAAW;AACT;AACA,ADSJ,AE1CA,IDiCI,GCjCJ,CAAA,CDiCS,ADSO,CCTN,OCjCV,EDiCmB,CAAC,ACjCpB,GF0CA,CAA+B,ECTrB,EDSV,CE1CA,CDiC8B,ADSY,ICTjC,EAA2B,KAA3B,EAAkC,SAAlC,CAAL;AACD,ADSD,GCZA,GDYI,GCTG,CDSC,IAAI,IAAR,IAAgB,OAAO,IAAP,KAAgB,SAApC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","file":"createApp.090b3aff.js","sourceRoot":"..","sourcesContent":["import { Component, ComponentInstance } from './component'\r\nimport { RendererElement } from './render'\r\ninterface VNodeProps {\r\n  key?: string | number\r\n  ref?: any\r\n  [key: string]: any\r\n}\r\nexport interface VNode<HostElement = RendererElement> {\r\n  __isVNode: true\r\n  type: VNodeType\r\n  props: VNodeProps | null\r\n  key: string | number | null\r\n  ref: any | null\r\n  children: VNodeChildren\r\n  shapeFlag: ShapeFlags\r\n\r\n  el: HostElement | null\r\n  component: ComponentInstance | null\r\n}\r\n\r\ntype VNodeType =\r\n  | string\r\n  | Component\r\n  | typeof Fragment\r\n  | typeof Text\r\n  | typeof Comment\r\ntype VNodeChildren = string | VNode[] | null\r\n\r\nexport const enum ShapeFlags {\r\n  ELEMENT = 1,\r\n  FUNCTIONAL_COMPONENT = 1 << 1,\r\n  STATEFUL_COMPONENT = 1 << 2,\r\n  TEXT_CHILDREN = 1 << 3,\r\n  ARRAY_CHILDREN = 1 << 4,\r\n  COMPONENT = ShapeFlags.FUNCTIONAL_COMPONENT | ShapeFlags.STATEFUL_COMPONENT,\r\n}\r\n\r\nexport const Fragment = Symbol('Fragment')\r\nexport const Text = Symbol('Text')\r\nexport const Comment = Symbol('Comment')\r\nexport const Static = Symbol('Static')\r\n\r\nexport const createVNode = (\r\n  type: VNodeType,\r\n  props: VNodeProps = null,\r\n  children: VNodeChildren = null\r\n): VNode => {\r\n  let vnode: VNode = {\r\n    __isVNode: true,\r\n    type,\r\n    props,\r\n    children,\r\n    key: null,\r\n    ref: null,\r\n    shapeFlag: 0,\r\n    component: null,\r\n    el: null,\r\n  }\r\n  return vnode\r\n}\r\n\r\n// 对即将挂载的node进行处理\r\nexport function normalizeVNode(node: VNode): VNode {\r\n  if (node == null || typeof node === 'boolean') {\r\n    // 创建空的注释节点\r\n    return createVNode(Comment)\r\n  } else if (Array.isArray(node)) {\r\n    return createVNode(Fragment, null, node)\r\n  } else if (typeof node === 'object') {\r\n    // 已经是vnode,这是最多的情况\r\n    if (node.el == null) {\r\n      // 没有挂载过\r\n      return node\r\n    } else {\r\n      // 已经挂载过\r\n      return cloneVNode(node)\r\n    }\r\n  } else {\r\n    //   其余情况都作为文本处理\r\n    return createVNode(Text, null, String(node))\r\n  }\r\n}\r\n\r\nexport function cloneVNode(\r\n  vnode: VNode,\r\n  extraProps?: VNodeProps | null\r\n): VNode {\r\n  return {\r\n    __isVNode: true,\r\n    type: vnode.type,\r\n    props: vnode.props,\r\n    children: vnode.children,\r\n    key: vnode.key,\r\n    ref: vnode.ref,\r\n    shapeFlag: vnode.shapeFlag,\r\n    component: vnode.component,\r\n    el: vnode.el,\r\n  }\r\n}\r\n","import {\r\n  VNode,\r\n  ShapeFlags,\r\n  Text,\r\n  Comment,\r\n  Static,\r\n  Fragment,\r\n  normalizeVNode,\r\n} from './vnode'\r\n\r\nconst rendererOptions = {\r\n  nextSibling(node: RendererNode) {\r\n    const el = node as HTMLElement\r\n    return el.nextSibling\r\n  },\r\n  //   暂不支持is ,web-component\r\n  createElement(tag: string, isSVG: boolean = false, is?: string) {\r\n    let el\r\n    if (isSVG) {\r\n      el = document.createElementNS('http://www.w3.org/2000/svg', tag)\r\n    } else {\r\n      el = document.createElement(tag)\r\n    }\r\n    return el\r\n  },\r\n  setElementText(el: RendererElement, text: string) {\r\n    ;(el as HTMLElement).innerText = text\r\n  },\r\n  insert(\r\n    el: RendererElement,\r\n    container: RendererElement,\r\n    anchor: RendererNode\r\n  ) {\r\n    if (anchor == null) {\r\n      ;(container as HTMLElement).appendChild(el as HTMLElement)\r\n    } else {\r\n      ;(container as HTMLElement).insertBefore(\r\n        el as HTMLElement,\r\n        anchor as Node\r\n      )\r\n    }\r\n  },\r\n}\r\n\r\nexport interface RendererNode {\r\n  [key: string]: any\r\n}\r\n\r\nexport interface RendererElement extends RendererNode {}\r\n\r\nexport function render(vnode: VNode, container: RendererElement) {\r\n  if (vnode) {\r\n    //\r\n    patch(container._vnode || null, vnode, container)\r\n  } else {\r\n    // 卸载\r\n    if (container._vnode) {\r\n      unmount(container._vnode)\r\n    }\r\n  }\r\n  container._vnode = vnode\r\n}\r\n\r\nexport function patch(\r\n  oldNode: VNode | null,\r\n  newNode: VNode,\r\n  container: RendererElement,\r\n  anchor: RendererNode | null = null, // 插入节点\r\n  isSVG: boolean = false\r\n) {\r\n  if (oldNode && !isSameNodeType(oldNode, newNode)) {\r\n    anchor = getNextAnchor(oldNode)\r\n    unmount(oldNode)\r\n    oldNode = null\r\n  }\r\n  let { type, shapeFlag } = newNode\r\n  //   先筛选type\r\n  switch (type) {\r\n    case Text:\r\n      console.log('处理text')\r\n      break\r\n    case Comment:\r\n      console.log('处理注释')\r\n      break\r\n    case Static:\r\n      console.log('处理静态节点')\r\n      break\r\n    case Fragment:\r\n      console.log('处理fragment')\r\n      break\r\n    default:\r\n      // 处理element和component\r\n      if (shapeFlag & ShapeFlags.ELEMENT) {\r\n        console.log('处理element patch')\r\n        processElement(oldNode, newNode, container, anchor, isSVG)\r\n      } else if (shapeFlag & ShapeFlags.COMPONENT) {\r\n        console.log('处理component patch')\r\n        processComponent(oldNode, newNode, container, anchor, isSVG)\r\n      }\r\n  }\r\n}\r\n\r\nfunction processElement(\r\n  oldNode: VNode,\r\n  newNode: VNode,\r\n  container: RendererElement,\r\n  anchor: RendererNode,\r\n  isSVG: boolean\r\n) {\r\n  isSVG = isSVG || newNode.type === 'svg'\r\n  if (!oldNode) {\r\n    // mount\r\n    mountElement(newNode, container, anchor, isSVG)\r\n  } else {\r\n    // patch\r\n  }\r\n}\r\n\r\nfunction mountElement(\r\n  node: VNode,\r\n  container: RendererElement,\r\n  anchor: RendererNode,\r\n  isSVG: boolean\r\n) {\r\n  const { type, shapeFlag, children } = node\r\n  let el: RendererElement\r\n  el = node.el = rendererOptions.createElement(type as string, isSVG)\r\n  //   处理children\r\n  if (shapeFlag & ShapeFlags.TEXT_CHILDREN) {\r\n    //   children是text\r\n    rendererOptions.setElementText(el, children as string)\r\n  } else if (shapeFlag & ShapeFlags.ARRAY_CHILDREN) {\r\n    //   children是数组\r\n    mountChildren(\r\n      children as VNode[],\r\n      el,\r\n      null,\r\n      isSVG && type !== 'foreignObject'\r\n    )\r\n  } else {\r\n    console.warn('node', node, '的children不是数组/text')\r\n  }\r\n\r\n  //TODO:   添加属性\r\n  //   挂载\r\n  rendererOptions.insert(el, container, anchor)\r\n  console.log('vnode:', node, 'mounted')\r\n}\r\n\r\nfunction processComponent(\r\n  oldNode: VNode,\r\n  newNode: VNode,\r\n  container: RendererElement,\r\n  anchor: RendererNode,\r\n  isSVG: boolean\r\n) {}\r\n\r\nfunction mountChildren(\r\n  children: VNode[],\r\n  container: RendererElement,\r\n  anchor: RendererNode | null = null,\r\n  isSVG: boolean\r\n) {\r\n  for (let i = 0; i < children.length; i++) {\r\n    let node = normalizeVNode(children[i])\r\n    // 挂载\r\n    patch(null, node, container, null, isSVG)\r\n  }\r\n}\r\n\r\n//  --------\r\n\r\nfunction getNextAnchor(node: VNode) {\r\n  if (node.shapeFlag & ShapeFlags.COMPONENT) {\r\n    return getNextAnchor(node.component.subTree)\r\n  }\r\n  return rendererOptions.nextSibling(node.el)\r\n}\r\n\r\nfunction isSameNodeType(n1: VNode, n2: VNode) {\r\n  return n1.type === n2.type && n1.key === n2.key\r\n}\r\n","import { Component } from '../runtime/component'\r\nimport { render } from '../runtime/render'\r\nimport { createVNode } from '../runtime/vnode'\r\n\r\nexport interface App<HostElement = HTMLElement> {\r\n  _container: HostElement | null\r\n  _component: Component | null\r\n  _context: AppContext\r\n  mount(container: HostElement): void\r\n  unmount(): void\r\n}\r\n\r\nexport interface AppContext {\r\n  app: App | null\r\n}\r\nexport function createAppContext(): AppContext {\r\n  return {\r\n    app: null,\r\n  }\r\n}\r\nexport function createApp(\r\n  rootComponent: Component,\r\n  rootProps?: Record<string, any>\r\n): App {\r\n  const context: AppContext = createAppContext()\r\n  let isMounted = false\r\n  const app: App = {\r\n    _component: rootComponent,\r\n    _container: null,\r\n    _context: context,\r\n    mount(container) {\r\n      if (!isMounted) {\r\n        const vnode = createVNode(rootComponent,rootProps)\r\n        render(vnode,container)\r\n        isMounted = true\r\n        app._container = container\r\n      }\r\n    },\r\n    unmount() {\r\n      //   卸载\r\n      if (isMounted) {\r\n        console.log('卸载app')\r\n        render(null,app._container)\r\n        app._container = null\r\n        isMounted = false\r\n      }\r\n    },\r\n  }\r\n  context.app = app\r\n  return app\r\n}\r\n","import {createApp} from '../seed/createApp'\r\nimport {createVNode} from '../runtime/vnode'\r\nconst rootNode = createVNode('h1',null,'测试挂载')\r\nconst app = createApp(rootNode,null)\r\nconsole.log(app)\r\n\r\napp.mount(document.getElementById('app'))"]}